<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Eurobox</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --bg:#0b1220;
  --card:#151c2f;
  --border:#2a3555;
  --text:#ffffff;
  --muted:#9aa3b2;
  --ok:#35d07f;
  --red:#ff4d4d;
  --grey:#C0C0C0;
}

body{
  margin:0;
  background:linear-gradient(180deg,#050810,#0b1220);
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  color:var(--text);
}

.container{
  max-width:480px;
  margin:20px auto;
  padding:20px;
}

.card{
  background:var(--card);
  border-radius:20px;
  padding:20px;
  box-shadow:0 0 40px rgba(0,0,0,.6);
  transition:.2s;
}

h1{
  text-align:center;
  margin:0;
  font-size:36px;
  letter-spacing:2px;
}

.status{
  text-align:center;
  color:var(--ok);
  margin-top:6px;
}

.row{
  display:flex;
  gap:10px;
  margin-top:16px;
}

input,textarea{
  background:#0f172a;
  border:1px solid var(--border);
  border-radius:14px;
  color:#fff;
  padding:12px;
  font-size:16px;
  width:100%;
}

textarea{
  height:180px;
  resize:none;
}

.icon{
  width:56px;
  height:56px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:26px;
  border-radius:16px;
  border:2px solid var(--border);
  cursor:pointer;
  transition:.15s;
}

.icon.active{
  border-color:var(--ok);
  box-shadow:0 0 12px rgba(53,208,127,.6);
}

.icon.heavy.active{
  border-color:var(--red);
  box-shadow:0 0 14px rgba(255,77,77,.7);
}

/* üé® Farbauswahl kleiner (50%) */
.color{
  width:28px;
  height:28px;
  border-radius:8px;
  border:2px solid #444;
}

.color.active{
  outline:2px solid var(--ok);
}

.weightBox{
  width:90px;
  text-align:center;
  font-weight:700;
}

.buttons{
  display:flex;
  gap:10px;
  margin-top:20px;
}

button{
  flex:1;
  padding:12px;
  border-radius:14px;
  border:none;
  background:#1f2a4d;
  color:#fff;
  font-size:14px;
}
</style>
</head>

<body>
<div class="container">
  <div class="card" id="card">

    <h1 id="boxId">E000</h1>
    <div class="status">Gespeichert ‚úì</div>

    <div class="row">
      <input id="ort" maxlength="6" placeholder="ORT">
      <input id="bez" placeholder="Bezeichnung">
    </div>

    <div class="row">
      <div class="icon" id="fragile" title="Zerbrechlich">üç∑</div>
      <div class="icon heavy" id="heavy" title="Schwer">üèãÔ∏è</div>
      <input id="kg" class="weightBox" type="number" min="0" max="99" placeholder="00 kg">
    </div>

    <div class="row">
      <div class="color active" id="grey" style="background:#C0C0C0"></div>
      <div class="color" id="black" style="background:#000"></div>
    </div>

    <textarea id="content" placeholder="‚Ä¢ Inhalt hier eintragen‚Ä¶"></textarea>

    <div class="buttons">
      <button onclick="exportBackup()">Backup nach iCloud</button>
      <button onclick="importBackup()">Backup importieren</button>
      <button onclick="loadJSON()">JSON laden</button>
    </div>

  </div>
</div>

<input type="file" id="fileInput" accept=".json" hidden>

<script>
const $ = id => document.getElementById(id);

const box = new URLSearchParams(location.search).get("box") || "E000";
$("boxId").textContent = box;

let data = JSON.parse(localStorage.getItem("Euroboxen")||"{}");

let state = data[box] || {
  ort:"",
  bez:"",
  content:"",
  fragile:false,
  heavy:false,
  kg:0,
  color:"grey"
};

// ---------- UI ----------
$("ort").value = state.ort;
$("bez").value = state.bez;
$("content").value = state.content || "‚Ä¢ ";
$("kg").value = state.kg || "";

function save(){
  state.ort = $("ort").value;
  state.bez = $("bez").value;
  state.content = $("content").value;
  data[box] = state;
  localStorage.setItem("Euroboxen", JSON.stringify(data));
}

$("fragile").onclick = ()=>{
  state.fragile=!state.fragile;
  $("fragile").classList.toggle("active",state.fragile);
  save();
};

$("kg").oninput=()=>{
  state.kg=parseInt($("kg").value||0);
  state.heavy=state.kg>=16;
  $("heavy").classList.toggle("active",state.heavy);
  save();
};

$("grey").onclick=()=>setColor("grey");
$("black").onclick=()=>setColor("black");

function setColor(c){
  state.color=c;
  $("grey").classList.toggle("active",c==="grey");
  $("black").classList.toggle("active",c==="black");
  $("card").style.background=c==="grey"?"#C0C0C0":"#000";
  save();
}

$("content").addEventListener("keydown",e=>{
  if(e.key==="Enter"){
    e.preventDefault();
    $("content").value+="\n‚Ä¢ ";
  }
  if(e.key==="Backspace" && $("content").value.endsWith("\n‚Ä¢ ")){
    $("content").value=$("content").value.slice(0,-3);
  }
});

document.querySelectorAll("input,textarea").forEach(el=>el.oninput=save);

// ---------- Backup ----------
function exportBackup(){
  const blob=new Blob([JSON.stringify(data,null,2)],{type:"application/json"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="Euroboxen.json";
  a.click();
}

function importBackup(){
  $("fileInput").click();
}

function loadJSON(){
  importBackup();
}

$("fileInput").onchange=e=>{
  const file=e.target.files[0];
  if(!file)return;
  const r=new FileReader();
  r.onload=()=>{
    data=JSON.parse(r.result);
    localStorage.setItem("Euroboxen",JSON.stringify(data));
    location.reload();
  };
  r.readAsText(file);
};

// Init
$("fragile").classList.toggle("active",state.fragile);
$("heavy").classList.toggle("active",state.heavy);
setColor(state.color);
</script>
</body>
</html>
