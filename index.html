<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Eurobox</title>

  <style>
    body {
      margin: 0;
      padding: 18px;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: #0b0f17;
      color: #e5e7eb;
    }

    .card {
      max-width: 700px;
      margin: auto;
      background: #111827;
      border-radius: 18px;
      padding: 18px;
      box-shadow: 0 20px 50px rgba(0,0,0,.4);
    }

    /* === Überschrift nebeneinander === */
    .headline {
      display: grid;
      grid-template-columns: auto 1fr;
      gap: 12px;
      align-items: center;
      margin-bottom: 16px;
    }

    .code {
      font-size: 36px;
      font-weight: 900;
      letter-spacing: 1px;
      font-family: ui-monospace, Menlo, Consolas, monospace;
    }

    .title {
      font-size: 36px;
      font-weight: 900;
    }

    .status {
      margin-top: 6px;
      font-size: 13px;
      color: #22c55e;
    }

    input, textarea {
      width: 100%;
      box-sizing: border-box;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.35);
      color: #e5e7eb;
      padding: 12px 14px;
      font-size: 18px;
      outline: none;
    }

    input:focus, textarea:focus {
      border-color: #6366f1;
    }

    textarea {
      min-height: 320px;
      resize: vertical;
      margin-top: 14px;
    }

    .row {
      display: grid;
      grid-template-columns: 120px 1fr;
      gap: 12px;
      margin-bottom: 10px;
    }

    @media (max-width: 520px) {
      .headline {
        grid-template-columns: 1fr 2fr;
      }
      .code, .title {
        font-size: 30px;
      }
      .row {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>

<body>
  <div class="card" id="app">
    <div class="headline">
      <div class="code" id="hCode">E00</div>
      <div class="title" id="hTitle">Eurobox</div>
    </div>

    <div class="status" id="status">Zugriff OK – wird automatisch gespeichert</div>

    <!-- Eingabe Überschrift -->
    <div class="row">
      <input id="inCode" maxlength="3" placeholder="E00" />
      <input id="inTitle" placeholder="Eurobox" />
    </div>

    <!-- Inhalt -->
    <textarea id="content" placeholder="Inhalt hier eintragen…"></textarea>
  </div>

<script>
  const params = new URLSearchParams(location.search);
  const box = params.get("box");
  const key = params.get("k");

  if (!box || !key) {
    document.body.innerHTML = "<h2 style='color:red'>Kein Zugriff</h2>";
    throw new Error("Kein Zugriff");
  }

  const storageKey = "eurobox_" + box + "_" + key;

  const hCode = document.getElementById("hCode");
  const hTitle = document.getElementById("hTitle");
  const inCode = document.getElementById("inCode");
  const inTitle = document.getElementById("inTitle");
  const content = document.getElementById("content");

  const defaults = {
    code: box.slice(0,3),
    title: "Eurobox",
    content: ""
  };

  let state;
  try {
    state = JSON.parse(localStorage.getItem(storageKey)) || defaults;
  } catch {
    state = defaults;
  }

  function render() {
    hCode.textContent = state.code;
    hTitle.textContent = state.title;
    inCode.value = state.code;
    inTitle.value = state.title;
    content.value = state.content;
  }

  function save() {
    localStorage.setItem(storageKey, JSON.stringify(state));
  }

  let t;
  function autoSave() {
    clearTimeout(t);
    t = setTimeout(save, 200);
  }

  inCode.addEventListener("input", () => {
    state.code = inCode.value.toUpperCase().slice(0,3);
    hCode.textContent = state.code;
    autoSave();
  });

  inTitle.addEventListener("input", () => {
    state.title = inTitle.value;
    hTitle.textContent = state.title;
    autoSave();
  });

  content.addEventListener("input", () => {
    state.content = content.value;
    autoSave();
  });

  render();
</script>
</body>
</html>
