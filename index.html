<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Euroboxen</title>
  <style>
    :root{
      --bg:#070c12;
      --panel:#0d1623;
      --panel2:#0b1320;
      --border:rgba(255,255,255,.10);
      --border2:rgba(255,255,255,.14);
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.55);
      --ok:#29d06b;
      --shadow:0 18px 55px rgba(0,0,0,.55);
      --radius:18px;
      --radius2:14px;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 600px at 50% -10%, #1a2a44 0%, var(--bg) 55%) fixed;
      color:var(--text);
      display:flex;
      align-items:center;
      justify-content:center;
      padding:18px;
    }

    .wrap{
      width:min(760px, 92vw);
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border:1px solid var(--border);
      border-radius:24px;
      box-shadow: var(--shadow);
      padding:22px;
    }

    .top{
      text-align:center;
      margin-bottom:10px;
    }

    .boxid{
      font-weight:800;
      letter-spacing:.06em;
      font-size:44px;
      line-height:1.05;
      margin:0;
    }

    .saved{
  margin-top:6px;
  font-size:14px;
  color:#29d06b;
  opacity:.65;                 /* dauerhaft sichtbar */
  transition:opacity .25s ease;
  user-select:none;
}
.saved.show{
  opacity:1;                   /* bei Änderung stärker sichtbar */
}


    .row{
      display:flex;
      gap:12px;
      margin-top:14px;
    }

    .input, .textarea{
      width:100%;
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid var(--border2);
      border-radius: var(--radius2);
      color:var(--text);
      outline:none;
      padding:14px 14px;
      font-size:18px;
      box-shadow: inset 0 1px 0 rgba(255,255,255,.05);
    }

    .input::placeholder, .textarea::placeholder{
      color:rgba(255,255,255,.35);
    }

    /* ORT Feld optisch etwas kompakter */
    .input.ort{
      max-width:170px;
      text-transform:uppercase;
      letter-spacing:.04em;
    }

    .textarea{
      margin-top:12px;
      min-height:280px;
      resize:vertical;
      font-size:20px;
      line-height:1.35;
      padding:16px;
    }

    /* Mobile Feinschliff */
    @media (max-width:560px){
      .wrap{padding:18px}
      .boxid{font-size:40px}
      .row{gap:10px}
      .input{font-size:18px}
      .textarea{font-size:20px; min-height:320px}
      .input.ort{max-width:140px}
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="top">
      <h1 class="boxid" id="boxTitle">Box E000</h1>
      <div class="saved" id="savedState">Gespeichert ✓</div>
    </div>

    <div class="row">
      <input id="ort" class="input ort" type="text" maxlength="6" placeholder="ORT" />
      <input id="bez" class="input" type="text" placeholder="Bezeichnung" />
    </div>

    <textarea id="inhalt" class="textarea" placeholder="Inhalt hier eintragen..."></textarea>
  </div>

  <script>
    // --- Box-ID aus URL ---
    const params = new URLSearchParams(location.search);
    const box = (params.get("box") || "E000").toUpperCase();

    // Header: "Box E012"
    const boxTitle = document.getElementById("boxTitle");
    boxTitle.textContent = `Box ${box}`;

    // Storage-Key pro Box
    const storageKey = `eurobox_${box}`;

    // Elemente
    const ortEl = document.getElementById("ort");
    const bezEl = document.getElementById("bez");
    const inhaltEl = document.getElementById("inhalt");
    const savedEl = document.getElementById("savedState");

    // Laden
    try{
      const data = JSON.parse(localStorage.getItem(storageKey) || "{}");
      ortEl.value = (data.ort || "").toUpperCase().slice(0,6);
      bezEl.value = data.bez || "";
      inhaltEl.value = data.inhalt || "";
    }catch(e){ /* ignore */ }

    // Speichern (debounced)
    let t = null;
    function showSaved(){
      savedEl.classList.add("show");
      setTimeout(()=> savedEl.classList.remove("show"), 1200);
    }

    function saveNow(){
      const data = {
        ort: (ortEl.value || "").toUpperCase().slice(0,6),
        bez: bezEl.value || "",
        inhalt: inhaltEl.value || "",
        updatedAt: Date.now()
      };
      localStorage.setItem(storageKey, JSON.stringify(data));
      showSaved();
    }

    function scheduleSave(){
      clearTimeout(t);
      t = setTimeout(saveNow, 250);
    }

    // ORT: Großschrift + max 6
    ortEl.addEventListener("input", () => {
      ortEl.value = (ortEl.value || "").toUpperCase().slice(0,6);
      scheduleSave();
    });

    // Rest
    bezEl.addEventListener("input", scheduleSave);
    inhaltEl.addEventListener("input", scheduleSave);

    // Beim Verlassen der Seite sicher speichern
    window.addEventListener("beforeunload", () => {
      clearTimeout(t);
      saveNow();
    });
  </script>
</body>
</html>
